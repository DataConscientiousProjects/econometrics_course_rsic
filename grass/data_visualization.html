<p>Resources: 
<a href="http://grass.osgeo.org/grass70/manuals/index.html">
GRASS GIS overview and manual</a>
</p>
<P><B>Topic: Data display and visualization</B></P>
<P>
<i>Screen captures for 3D visualization with wxnviz in GRASS6.4.3RC2 (similar to GRASS7)</i><br>
<a href="http://courses.ncsu.edu/mea582/common/media/03/sc_wxnviz1_edit1large.mov"> Visualization in GRASS I: surface (71MB)</a><br> 
<a href="http://courses.ncsu.edu/mea582/common/media/03/sc_wxnviz2_edit2.mov"> Visualization in GRASS II: draping points and lines (45MB)</a><br> 
<a href="http://courses.ncsu.edu/mea582/common/media/03/sc_wxnviz3_edit.mov"> Visualization in GRASS III: cutting planes (62MB)</a><br>
<!--
<P>
If you are using GRASS6.4.3 or later you can switch to 3D view within your map display
and create visualizations shown in the video using a new GUI written in wxpython.
See the 
<a href="http://grass.osgeo.org/grass70/manuals/html70_user/wxGUI.Nviz.html">
<b>Manual</b> and links to related wiki page and videos there</a>
</P>
-->
<P>
<i>
The assignment includes both GUI (buttons and menus) and command-line workflow, you can use 
any of those or their combination, based on the task that you are doing (no need to do both).
On MSWindows, it  is recommended to use wxGUI equivalents of d.* commands: </i></font>
<P> in GRASS GIS Layer Manager
<ul>
 <li>d.rast : <font color="#000066">Add raster map layer</font>
 <li>d.vect : <font color="#000066">Add vector map layer</font>
 <li>d.shadedmap : <font color="#000066">Add various raster map layers>Add shaded relief map</font>
</ul>
in GRASS GIS Map Display
<ul>
<!-- <li>d.what.rast : <font color="#000066">Query raster map</font>
 <li>d.what.vect -x : <font color="#000066">Query vector map</font> -->
 <li>d.zoom : <font color="#000066"> Zoom options</font>
 <li>d.erase : <font color="#000066">Zoom to computational region, erase display</font>
 <li>d.out.file : <font color="#000066">Save display to graphic file</font>
 <li>d.barscale : <font color="#000066">Add map elements > Add scalebar</font>
 <li>d.legend : <font color="#000066">Add map elements > Add legend</font>
</ul>
<i>
<b>To find additional GUI button equivalents for d.* commands 
<font color="#990000">Read GUI help </font></b>
</i>
</font>

<pre><code>
grass70 
</code></pre>

<p>
in the startup pannel<br>
GIS data directory: type path to GRASS datasets<br>
LOCATION: select nc_spm_08<br>
MAPSET: use mapset with your unity ID or user1<br>
Enter GRASS<br>

<b>Visualization in 3D perspective</b><br>

p. 273-280 in GRASSbook<br>
set the region to the raster elevation<br>
interactively view elevation raster and vector data (streams, usgsgauges) in 3D space,<br>
adjust viewing position, surface properties and lighting to highlight features<br>

<pre><code>
g.region raster=elevation -p <!--nviz elevation vector=roadsmajor point=schools_wake-->
</code></pre>

<p>
remove or switch off any map layers in the layer manager<br>
Add raster elevation, Add vector streams, Add vector usgsgauges<br>
Zoom to computational region<br>
Switch to 3d view<br>
follow the video Visualization I and II for similar tasks (link is above)<br>
save 2-3 images for your report<br>
(save as tiff or take screenshot, if you don't have tiff support)<br>

It is recommended to quit GRASS before starting the task below<br>
because we will be working with a smaller, high resolution region<br>

Visualize multiple surfaces (bare earth and surface with vegetation and structures),<br>
analyze their relationship using crossections generated by interactive cutting planes<br>

start GRASS7 with LOCATION nc_spm_08 and your previous MAPSET<br>
First set region to rural_1m, then interpolate surface with vegetation<br>
from multiple return lidar points using the module v.surf.rst<br>
(we will explain interpolation later on)<br>

<pre><code>
g.region rural_1m -p
v.surf.rst elev_lidrural_mrpts elevation=elev_lidruralmr_1m npmin=120 segmax=25 tension=300 smooth=1.0
</code></pre>

<p>
In GIS layer manager Add rasters elev_lidrural_mrpts and elev_lid792_1m (bare earth)<br>
In Map Display Zoom to computational region<br>
make sure that you have only the two elevation maps switched on in the layer manager<br>
Switch to 3d view and follow the video Visualization III (link is above)<br>
save 2-3 interesting images for your report, include at least one crossection<br>
<!--nviz elev_lidruralmr_1m,elev_lid792_1m-->

<b>Basic 2D display operations</b><br>
GUI is recommended for the tasks below,<br>
see the GUI equivalents for selected d* commands above,<br>
the command line is to indicate the workflow and output<br>

p. 84-85<br>
Display subsets of data:<br>
visualy explore relation between developed areas and topography<br>

Display land use categories 1, 2 (developed land) over shaded topography<br>
Settingsa> Region > Set region > Set region to match this raster > landuse96_28m<br>
Add raster > elevation_shade<br>
Add raster > landuse96_28m > Selection > List of cats to display > 1,2<br>
Zoom to computational region<br>
Right click on landuse96_28m and Change opacity to show topography blended with landuse<br>
Save display to graphic file<br>

<pre><code>
g.region raster=landuse96_28m -p
d.erase
d.rast elevation_shade
d.rast landuse96_28m values=1,2
d.out.file landuse_elev
</code></pre>

<p>
<!--
<font color="#000066">
# Following the example above
# display elevations with values within intervals <50,80> and <120,160> over geology 
# elevation is continuous field map, so we use val instead of cat for Selection
# set opacity level for the elevation to 50% to see the underlying geology
</font>
d.rast geology_30m
d.rast elevation val=50-80,120-160 -o
-->
Change colors for raster maps (there are many ways how to do it see <a href="http://grass.osgeo.org/grass70/manuals/r.colors.html"><b>r.colors</b> manual</a>)<br>

first create your own copy of the elevation map (see the command below)<br>
display it by Add raster > myelev<br>

<pre><code>
g.copy raster=elevation,myelev
d.rast myelev
</code></pre>

<p>
set the color table to a predefined one, for example bgyr (blue,green,yellow,red)<br>
GUI options: Right Click on the raster layer in Layer Mmanager<br>
myelev > Set color table > Define > Name of color table > bgyr > Run<br>
if you don't see the new colors - click the second button in Map Display to redraw<br>

<pre><code>
r.colors myelev color=bgyr
d.rast myelev
</code></pre>

<p>
change the color table interactively using rules<br>
in the Layer Manager click  Raster->Manage colors->Color rules<br>
select raster map myelev<br>
Click on colored squares to change the color, click Preview<br>
if it looks good - click OK<br>

To create color table for future multiple uses<br>
type the rules into a plain text mycolor.txt file<br>
using a text editor (TextEdit, Notepad), for example:<br>

<pre>
50 blue
70 aqua    
90 green
110 yellow
130 orange
160 brown
</pre>

<p>
then assign it as follows:<br>
right click on myelev > set color table > Define > Path to rules file > Run<br>
if needed, redraw using the second button on Map Display<br>
you can also create and assign the above color table by typing or pasting it into the<br>
"enter values interactively" window<br>
or run it from comand line (make sure you have the correct path)<br>

<pre><code>
r.colors myelev rules=/Users/helena/mycolor.txt
</code></pre>

<p>
note that you can combine color RGB and name definitions<br>
as well as % and cat/val to create complex custom color tables<br>
and store them in a text file for future use, see the examples in r.colors man page<br>

compare the use of equal interval and histogram equalized color table for slope<br>
To add the legend use Add legend button on Map display<br>
under Set options,  make sure to change name of raster to myslope<br>
to explain the difference between the two maps, you can generate a histogram<br>
On map Display click on Analyze map>Create histogram to open the histogram tool<br>
save results to graphics file<br>

<pre><code>
g.copy raster=slope,myslope
r.colors myslope color=bgyr
d.rast myslope
d.legend raster=myslope
d.out.file myslopecolor
r.colors -e myslope color=bgyr
d.histogram myslope
d.out.file myslopecolor
</code></pre>

<p>
Modify legend, scale and grid<br>

To re-size the legend for myslope, right click on the legend,<br>
select Resize legend and resize with mouse.<br>
Alternatively you can resize by double clicking on legend to launch the legend dialog<br>
and set options > Optional > Placement >50,90,4,7.<br>
Numbers are bottom,top,left,right as percentage of screen coordinates.<br>
add units to the legend: Add map elements > Add text layer > Enter text > type deg > OK<br>
add barscale on Map Display: Add map elements > Show/hide north arrow (double click on it to change it)<br>

<pre><code>
d.barscale 
d.legend raster=myslope at=50,90,4,7
</code></pre>

<p>
note: you can use horizontal legends by using Placement at=6,10,2,30<br>
or just stretch it horizontally with mouse<br>
you can stretch your map display vertically to create white space above and below the image<br>

Switch off myslope, display myelev raster and change the legend to myelev raster<br>
Add grid for state plane coordinates at 5000m with ticks at 1000m<br>
Also add a lat/long grid at 2 arc minute interval<br>
In Layer Manager > Add grid  or vector labels> Add grid layer > Size 5000 > Run<br>
To draw only border with ticks: change Size to 1000 and click Disable > Disable grid drawing > Run<br>
switch off disable grid drawing<br>
To draw lat/long grid: set Required > Size to 0:02 click Draw > Draw geographic grid > Run<br>
command line alternative<br>

<pre><code>
d.rast myelev
d.legend myelev
d.grid size=5000 color=brown
d.grid -n size=1000
d.grid -g size=0:02 color=black
d.out.file myelevmap
</code></pre>

<p>
Display color composite<br>
GUI: Add various raster-based layers > Add RGB<br>

<pre><code>
d.rgb red=lsat7_2002_30 green=lsat7_2002_20 blue=lsat7_2002_10 
d.vect roadsmajor color=yellow
d.out.file mylandsat
</code></pre>

<p>
Export NC precipitation stations data to kml and post in Google Earth<br>
If your are running the command in GUI do not forget to click point for data type<br>
To view the data in Google Earth just drag and drop the kml file in the Google Earth window<br>

<pre><code>
g.region nc_500m
v.out.ogr precip_30ynormals output=c:\temp\precipitation.kml format=KML type=point
</code></pre>

<p>
Optional - please test these tasks and report whether they worked without problems<br>
View and download orthophoto through web mapping service<br>
first change region to the small rural area and display the provided orthophoto<br>


<pre><code>
g.region rural_1m -p
d.rast ortho_2001_t792_1m
</code></pre>

<p>
In Layer Manager toolbar Add web service layer<br>
paste the link to the service into server field and press connect:<br>
http://services.nconemap.com/arcgis/services/Imagery/Orthoimagery_All/ImageServer/WMSServer?<br>
Wait until GUI changes.<br>
In list of layers, there should be Orthoimagery_All, click on that.<br>
Press Add layer button and wait.<br>
The dialog can be closed afterwards.<br>

To save the layer:<br>
Right click on the web service layer in Layer Manager - choose Save web service layer<br>
In dialog, set the name of the layer  ortho_new and press Save layer.<br>

Use mapswipe to compare the new orthophoto with the ortho provided in the data set<br>
File -> Map Swipe<br>
Add raster > select ortho_2001_t792_1m and ortho_new<br>
move slider to compare images - what changes do you observe?<br>
save a screenshot of the mapswipe window showing the comparison of orthos<br>
see more options here: http://grasswiki.osgeo.org/wiki/WxGUI_Map_Swipe<br>


<p>
<!--
<font color="#000066">
# Set color scheme for vector data, display vector data attributes
</font>
g.region rast=elevation -p
g.copy vect=streets_wake,mystreets
v.colors mystreets column=SPEED color=rainbow
d.vect -a mystreets 
#
# if the above does not work try this
#
v.db.addcol map=mystreets columns="myrgb varchar(11)"
v.colors mystreets column=SPEED color=rainbow rgb_column=myrgb
d.vect -a mystreets rgb_column=myrgb

<font color="#000066">
# Export data to kml and post in Google Earth# If your are running the command in GUI do not forget to click point for data type
# To view the data in Google Earth just drag and drop the kml file in the Google Earth window
</font>
g.region nc_500m
v.out.ogr precip_30ynormals dsn=c:\temp\precipitation.kml format=KML type=point


<font color="#000066">
# Draw thematic vector map showing number of children 10-14 in census blocks and school capacity
# In GIS Layer Manager Add various vector maps > Add thematic layer
# Tab Required > censusblk_swwake, Feature type > area, Name of attribute> P10_TO_14, 
# Type of display>graduated_colors, Thematic divisions>interval, Color scheme > yellow-cyan
# Tab Theme > Number of classes > 12, OK 
#
# In GIS Layer Manager Add various vector maps > Add thematic layer
# Required > schools_wake, Feature type > point, Name of attribute> CORECAPACI, 
# Type of display>graduated_points, Thematic divisions>interval
# Theme > Number of classes > 10
# Points > Icon size > 3, Max icon size > 30
</font>
d.vect.thematic -gs map=censusblk_swwake type=area column=P10_TO_14 themetype=graduated_colors nint=15 colorscheme=yellow-cyan
d.vect.thematic -gs map=schools_wake type=point column=CORECAPACI themetype=graduated_points size=3 maxsize=30 nint=10 colorscheme=blue-red
v.colors mycensus column=P10_TO_14 color=bcyr

<font color="#000066">
# derive RGB channels from hue and intensity
# save shaded map with basins as a single raster layer
</font>
g.region rast=elevation -p
r.his h=basin_50K i=elevation_shade b=el_b g=el_g r=el_r
<font color="#000066">
# create a single composite map
</font>
r.composite b=el_b g=el_g r=el_r out=basins_shaded_10m
d.rast basins_shaded_10m
-->

</div>

